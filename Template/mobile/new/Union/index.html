<!DOCTYPE html >
<html>
<head>
    <meta name="Generator" content="gjshop v1.1" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <title>发现-商业联盟</title>
    <meta http-equiv="keywords" content="{$gjshop_config['shop_info_store_keyword']}" />
    <meta name="description" content="{$gjshop_config['shop_info_store_desc']}" />
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>
    <link rel="stylesheet" type="text/css" href="__STATIC__/css/public.css?v=20161212152343"/>
    <link rel="stylesheet" type="text/css" href="__STATIC__/css/index.css?v=20161212152343"/>
    <link rel="stylesheet" type="text/css" href="__STATIC__/IconFont/iconfont.css?v=20161212152343"/>
    <link href="__PUBLIC__/bootstrap/css/font-awesome.min.css?v=20161212152343" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="__STATIC__/js/jquery.js"></script>
    <script type="text/javascript" src="__STATIC__/js/TouchSlide.1.1.js"></script>
    <script type="text/javascript" src="__STATIC__/js/jquery.json.js"></script>
    <script type="text/javascript" src="__STATIC__/js/touchslider.dev.js"></script>
    <script type="text/javascript" src="__STATIC__/js/layer.mobile-v2.0/layer_mobile/layer.js" ></script>
    <script src="__PUBLIC__/js/global.js"></script>
    <script src="__PUBLIC__/js/mobile_common.js"></script>
    <style>
        body {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <div id="page" class="showpage">
        <div>
            <div id="scrollimg" class="scrollimg">
                <div class="bd">
                    <ul>
                        <adv pid ="51318" limit="5" item="v">
                            <li>
                                <a href="{$v.ad_link}" <if condition="$v['target'] eq 1">target="_blank"</if>
                                >
                                    <img src="{$v[ad_code]}" title="{$v[title]}"width="100%" style="{$v[style]}"/>
                                </a>
                            </li>
                        </adv>
                    </ul>
                </div>
                <div class="hd">
                    <ul></ul>
                </div>
            </div>
            <script type="text/javascript">
                TouchSlide({
                    slideCell:"#scrollimg",
                    titCell:".hd ul", //开启自动分页 autoPage:true ，此时设置 titCell 为导航元素包裹层
                    mainCell:".bd ul",
                    effect:"leftLoop",
                    autoPage:true,//自动分页
                    autoPlay:true //自动播放
                });
            </script>
        </div>
    </div>

<style>

    .icon-wrapper {
        margin: 10px 0;
        padding: 10px 0;
        box-shadow: 0px 5px 7px rgb(216, 216, 216);
        margin-top: 5px;
        padding-bottom: 5px;
        background-color: #fff;
        margin-top: 0;
        padding-top: 15px;
    }

    .icon-list dd {
        width: 25%;
        float: left;
        display: inline-block;
        text-align: center;
        padding-top: 5px;
    }

    .icon-list .icon {
        display: block;
        font-size: 2.8rem;
        color: #fff;
        background-color: #1E909C;
        width: 3.8rem;
        height: 3.8rem;
        padding: 2px;
        line-height: 3.8rem;
        text-align: center;
        margin: 0 auto;
        border-radius: 50%;
        transition: all 0.2s ease-out;
    }

    .icon-list .icon.on {
        box-shadow: 0px 1px 3px #000000!important;
        transform: rotate(360deg);
    }

    .icon-list .icon.no {
        /*-webkit-filter: grayscale(92%);*/
    }

    .icon-list .icon-desc {
        display: block;
        color: #333;
        font-size: 1.2rem;
    }
    .icon-list .seller-num {
        display: block;
        color: #fff;
        font-size: 1.2rem;
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        margin: auto;
        background-color: rgba(0, 0, 0, 0.55);
        height: 17px;
        line-height: 17px;
        width: 17px;
        padding: 1px 2px;
        border-radius: 6px;
        text-align: center;
        top: -67px;
        right: -45px;
        text-shadow: 2px 2px 5px #000;
        transition: all 0.2s ease-out;
        overflow: hidden;
        opacity: .6;
    }
    .icon-list .seller-num.w {
        width: 25px;
    }
    .icon-list .seller-num.no {
        width: 0;
        height: 0;
        padding: 0;
        /*top: -27px;right: -25px;*/
    }
    .icon-list dd:nth-child(5+n) {
        margin-top: 10px;
    }
    .icon-list dd a {
        display: block;
        position: relative;
    }


    #ico-s .hd {
        position: inherit;
        height: 11px;
        line-height: 0px;
    }

    #ico-s .hd li {
        background-color: #8C8C8C;
    }

    #ico-s .hd li.on {
        background-color: rgb(0, 211, 190);
    }

</style>
<div class="icon-wrapper">
    <div id="ico-s" class="scrollimg">
        <div class="bd">
            <ul>
                <li>
                    <dl class="icon-list">
                        <dd>
                            <a href="javascript:void(0);" data-cat="0">
                                <i class="icon no iconfont icon-meishi" style="background: #fd9d21;    box-shadow: 0px 1px 3px #fd9d21;"></i>
                                <span class="icon-desc">餐饮</span>
                            </a>
                        </dd>
                        <dd>
                            <a href="javascript:void(0);" data-cat="1">
                                <i class="icon no iconfont icon-dianying" style="    background: #ff6767;    box-shadow: 0px 1px 3px #ff6767;"></i>
                                <span class="icon-desc">电影</span>
                            </a>
                        </dd>
                        <dd>
                            <a href="javascript:void(0);" data-cat="2">
                                <i class="icon no iconfont icon-jiudianicon" style="background: #8a90fa;    box-shadow: 0px 1px 3px #8a90fa;"></i>
                                <span class="icon-desc">酒店宾馆</span>
                            </a>
                        </dd>
                        <dd>
                            <a href="javascript:void(0);" data-cat="3">
                                <i class="icon no iconfont icon-jiushui" style="    background-color: #BF5CFD;    box-shadow: 0px 1px 3px #BF5CFD;"></i>
                                <span class="icon-desc">酒水超市</span>
                            </a>
                        </dd>
                        <dd>
                            <a href="javascript:void(0);" data-cat="8">
                                <i class="icon no iconfont icon-xiuxian-copy" style="background: #21CAFD;    box-shadow: 0px 1px 3px #21CAFD;"></i>
                                <span class="icon-desc">休闲娱乐</span>
                            </a>
                        </dd>
                        <dd>
                            <a href="javascript:void(0);" data-cat="18">
                                <i class="icon no iconfont icon-diannao" style="background: #5264E4;    box-shadow: 0px 1px 3px #5264E4;"></i>
                                <span class="icon-desc">电脑电器</span>
                            </a>
                        </dd>
                        <dd>
                            <a href="javascript:void(0);" data-cat="6">
                                <i class="icon no iconfont icon-xiebaopeishi" style="    background: #ff80c2;    box-shadow: 0px 1px 3px #ff80c2;"></i>
                                <span class="icon-desc">服装鞋包</span>
                            </a>
                        </dd>
                        <dd>
                            <a href="javascript:void(0);" data-cat="7">
                                <i class="icon no iconfont icon-meirong" style="background: #00d3be;    box-shadow: 0px 1px 3px #00d3be;"></i>
                                <span class="icon-desc">美容美发</span>
                            </a>
                        </dd>
                        <div class="clear"></div>
                    </dl>
                </li>
                <li style="display: none;">
                    <dl class="icon-list">
                        <dd>
                            <a href="javascript:void(0);" data-cat="17">
                                <i class="icon no iconfont icon-chuzu" style="    background: #D428CF;    box-shadow: 0px 1px 3px #D428CF;"></i>
                                <span class="icon-desc">汽修美容</span>
                            </a>
                        </dd>
                        <dd>
                            <a href="javascript:void(0);" data-cat="9">
                                <i class="icon no iconfont icon-yundong" style="    background: #53CBC5;    box-shadow: 0px 1px 3px #53CBC5;"></i>
                                <span class="icon-desc">运动保健</span>
                            </a>
                        </dd>
                        <dd>
                            <a href="javascript:void(0);" data-cat="10">
                                <i class="icon no iconfont icon-jiaju" style="background: #FA9F8A;    box-shadow: 0px 1px 3px #FA9F8A;"></i>
                                <span class="icon-desc">家居用品</span>
                            </a>
                        </dd>
                        <dd>
                            <a href="javascript:void(0);" data-cat="11">
                                <i class="icon no iconfont icon-jiancai" style="    background-color: #5CF6FD;    box-shadow: 0px 1px 3px #5CF6FD;"></i>
                                <span class="icon-desc">装修建材</span>
                            </a>
                        </dd>
                        <dd>
                            <a href="javascript:void(0);" data-cat="12">
                                <i class="icon no iconfont icon-73316" style="background-color: #FF3D3D;    box-shadow: 0px 1px 3px #FF3D3D;"></i>
                                <span class="icon-desc">医疗</span>
                            </a>
                        </dd>
                        <dd>
                            <a href="javascript:void(0);" data-cat="13">
                                <i class="icon no iconfont icon-baoji" style="    background-color: #F568E4;    box-shadow: 0px 1px 3px #F568E4;"></i>
                                <span class="icon-desc">教育培训</span>
                            </a>
                        </dd>
                        <dd>
                            <a href="javascript:void(0);" data-cat="16">
                                <i class="icon no iconfont icon-meiti" style="background: #21CAFD;    box-shadow: 0px 1px 3px #21CAFD;"></i>
                                <span class="icon-desc">文化传媒</span>
                            </a>
                        </dd>
                        <dd>
                            <a href="javascript:void(0);" data-cat="15">
                                <i class="icon no iconfont icon-chuzu" style="background: #29C38A;    box-shadow: 0px 1px 3px #29C38A;"></i>
                                <span class="icon-desc">汽车</span>
                            </a>
                        </dd>
                        <div class="clear"></div>
                    </dl>
                </li>
                <li style="display: none;">
                    <dl class="icon-list">
                        <dd>
                            <a href="javascript:void(0);" data-cat="14">
                                <i class="icon no iconfont icon-baoxian" style="    background: #29C343;    box-shadow: 0px 1px 3px #29C343;"></i>
                                <span class="icon-desc">保险金融</span>
                            </a>
                        </dd>
                        <dd>
                            <a href="javascript:void(0);" data-cat="4">
                                <i class="icon no iconfont icon-shuiguo" style="background-color: #FD58B4;    box-shadow: 0px 1px 3px #FD58B4;"></i>
                                <span class="icon-desc">水果蔬菜</span>
                            </a>
                        </dd>
                        <dd>
                            <a href="javascript:void(0);" data-cat="5">
                                <i class="icon no iconfont icon-techan" style="    background-color: #7D68F5;    box-shadow: 0px 1px 3px #7D68F5;"></i>
                                <span class="icon-desc">茶叶特产</span>
                            </a>
                        </dd>
                        <dd>
                            <a href="javascript:void(0);" data-cat="19">
                                <i class="icon no iconfont icon-OAbangong" style="background: #2FCA2D;    box-shadow: 0px 1px 3px #2FCA2D;"></i>
                                <span class="icon-desc">办公用品</span>
                            </a>
                        </dd>
                        <dd>
                            <a href="javascript:void(0);" data-cat="20">
                                <i class="icon no iconfont icon-gengduo" style="background: #E6E6E6;    box-shadow: 0px 1px 3px #E6E6E6;"></i>
                                <span class="icon-desc">其他</span>
                            </a>
                        </dd>
                        <div class="clear"></div>
                    </dl>
                </li>
            </ul>
        </div>
        <div class="hd">
            <ul></ul>
        </div>
    </div>
</div>

<script type="text/javascript">
    TouchSlide({
        slideCell:"#ico-s",
        titCell:".hd ul", //开启自动分页 autoPage:true ，此时设置 titCell 为导航元素包裹层
        mainCell:".bd ul",
        effect:"leftLoop",
        autoPage:true,//自动分页
        autoPlay:false //自动播放
    });
    // 解决闪动问题，其实这一句不要也可以，默认会自动显示出来的
    $('#ico-s li').show();
</script>


<style>
    #guessLike {
        margin: 20px 0;
    }
    #guessLike .title {
        border-left: 5px #1E909C solid;
        padding-left: 10px;
        margin-left: 4px;
        height: 20px;
        font-size: 1.8rem;
        line-height: 20px;
        margin-bottom: 15px;
    }
    #guessLike .dealcard {
        margin: 10px 0;
        overflow: hidden;
    }

    #guessLike .dealcard-img {
        height: 160px;
        width: 160px;
        position: absolute;
        z-index: 1;
    }

    #guessLike .dealcard-block-right {
        padding-left: 168px;
        height: 158px;
        border-top: 1px rgba(191, 92, 253, 0.55) solid;
        border-bottom: 1px rgba(187, 187, 187, 0.55) solid;
        position: relative;
    }
    #guessLike .more {
        text-align: center;
    }

    #guessLike .dealcard-brand {
        font-size: 1.8rem;
        overflow: hidden;
        white-space: nowrap;
        text-overflow: ellipsis;
    }

    #guessLike .seller-item {
        margin: 10px 0;
        /*box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.28);*/
        background-color: #fff;
    }
    #guessLike .local {
        height: 30px;
        line-height: 30px;
        overflow: hidden;
        white-space: nowrap;
        text-overflow: ellipsis;
        display: block;
        margin-top: 10px;
        font-size: 1.3rem;
        color: #666;
    }
    #guessLike .distance {
        color: #6D3DA3;
    }
    #guessLike .category {
        padding: 0 3px;
        font-size: 1.2rem;
        bottom: -1px;
        left: 0;
        position: absolute;
        background-color: rgba(0, 0, 0, 0.65);
        height: 19px;
        line-height: 19px;
        color: #fff;
        z-index: 2;
    }

    #guessLike .special {
        padding: 0 3px;
        font-size: 1.2rem;
        top: -1px;
        left: 0;
        position: absolute;
        background-color: rgba(0, 0, 0, 0.65);
        height: 19px;
        line-height: 19px;
        color: #fff;
        z-index: 2;
        background-image: linear-gradient(rgba(53, 12, 78, 0.91)10px,rgba(90, 75, 214, 0.45)15%);
        text-shadow: 2px 2px 5px #000;
    }
    #guessLike .special .icon {
        margin-right: 2px;
    }

    #guessLike .special- {
        position: absolute;
        top: -1px;
        right: 0;
        background: -webkit-gradient(linear,0 50%,100% 50%,from(rgb(233, 45, 88)),to(rgb(101, 75, 244)));
        color: #fff;
        width: 26px;
        text-align: center;
        background-image: linear-gradient(rgb(41, 195, 138)0px,rgba(65, 224, 224, 0)99%);
        height: 40px;
        line-height: 29px;
        text-shadow: 0px 1px 0px #35B3A1;
    }
    #guessLike .special- .icon {
        font-size: 2.6rem;
    }

    #guessLike .consumption {
        margin-left: 5px;
        padding: 0 5px;
        font-size: 1.2rem;
        background-color: rgb(160, 61, 173);
        height: 30px;
        line-height: 30px;
        color: #FFF;
        background: -webkit-gradient(linear,0 50%,100% 50%,from(rgb(40, 199, 155)),to(rgb(181, 208, 33)));
    }

    #guessLike .discount,#guessLike .note {
        margin-left: 6px;
        /* border: 1px #2895A0 solid; */
        color: #FFFFFF;
        padding: 0 5px;
        font-size: 1.3rem;
        background: -webkit-gradient(linear,0 50%,100% 50%,from(rgb(233, 45, 88)),to(rgb(101, 75, 244)));
        padding: 2px 5px;
    }
    #guessLike .discount {
        background: -webkit-gradient(linear,0 50%,100% 50%,from(rgb(56, 183, 148)),to(rgb(45, 166, 202)));
        /*border-radius: 10px;*/
        margin-left: 0;
    }

    #getmore a {
        display: block;
        text-align: center;
    }
    #positioning {
        color: #FFFFFF;
        font-size: 1.3rem;
        margin-left: 10px;
        background-color: #00D3BE;
        padding: 3px 7px;
        border-radius: 9px;
    }
</style>

<div id="guessLike" class="guess-like">
    <dl class="list" style="opacity: 1;">
        <dd>
            <dl class="list" id="ajax_return" style="opacity: 1;">
                <dt class="title">附近商家<span id="positioning"><i class="fa fa-refresh fa-spin"></i>&nbsp;&nbsp;正在定位…</span></dt>
                <dd id="get_more_load">
                    <a href="javascript:;" style="text-align:center; display:block;">
                        <img src="__STATIC__/images/category/loader.gif" width="12" height="12">
                    </a>
                </dd>
                <dd id="getmore" style="display: none;"><a href="javascript:void(0)" onclick="getSeller()">查看更多</a></dd>
            </dl>
        </dd>
    </dl>
</div>


<!-- 这个先加载，渲染比较好，不然要慢慢最后才显示，体验会不好的 -->
<include file="Public/footer_nav"/>

<script>
    var Local = {longitude:0, latitude:0};
    var cat = 'all';
    var p = 1;
    // $(function(){

        // 定位
        if(typeof wx != "undefined") {

            $('#positioning').click(function() {
                getWxLocation(callback);
            });

            wx.ready(function(){
                // 微信定位接口
                getWxLocation(callback);
            });
        } else {

            $('#positioning').click(function() {
                getLocation(callback);
            });

            // 普通定位接口
            getLocation(callback);
        }

        $('.icon-list dd a').click(function() {

            if ($(this).find('i').hasClass('on')) {
                $('.icon-list dd a').find('i').removeClass('on');
                cat = 'all';
            } else {
                $('.icon-list dd a').find('i').removeClass('on');
                $(this).find('i').addClass('on');
                cat = $(this).data('cat');
            }

            $('.seller-item').empty();
            p = 1;
            getSeller();
        });
    // });

    // 定位之后的回调
    function callback() {
        // 初始化
        $('.seller-item').empty();
        p = 1;
        // 拉取商家列表
        getSeller();
        // 获取商家数量
        getSellerNum();
        // 获取地理位置名称
        getLocalName('wgs84ll', callback2);
    }

    // 获取到地理位置之后的回调
    function callback2(result) {
        console.log(result);
        $('#positioning').html('<i class="icon no iconfont icon-31dingwei"></i>&nbsp;' + result.result.formatted_address);
    }

    // 微信定位
    function getWxLocation(callback) {
        layer.open({content: '<i class="fa fa-refresh fa-spin"></i>&nbsp;&nbsp;正在定位…', skin:'msg', time:2});
        $('#positioning').html('<i class="fa fa-refresh fa-spin"></i>&nbsp;&nbsp;正在定位…');

        wx.getLocation({
            type: 'wgs84', // 默认为wgs84的gps坐标，如果要返回直接给openLocation用的火星坐标，可传入'gcj02'
            success: function (res) {
                Local.latitude  = res.latitude; // 纬度，浮点数，范围为90 ~ -90
                Local.longitude = res.longitude; // 经度，浮点数，范围为180 ~ -180。
                Local.speed     = res.speed; // 速度，以米/每秒计
                Local.accuracy  = res.accuracy; // 位置精度
                console.log(Local);
            },
            fail: function (errMsg) {
                console.log(errMsg);
            },
            complete: function () {
                console.log('Local to complete');
                callback();
            },
            cancel: function () {
                alert('you cancel getLocation');
            }
        });
    }

    // 普通定位
    function getLocation(callback) {
        layer.open({content: '<i class="fa fa-refresh fa-spin"></i>&nbsp;&nbsp;正在定位…', skin:'msg', time:2});
        $('#positioning').html('<i class="fa fa-refresh fa-spin"></i>&nbsp;&nbsp;正在定位…');

        Local.longitude = '114.921551';
        Local.latitude = '30.480784';
        callback();
        return;
        getLocationApi(function (position) {
            Local.longitude = position.coords.longitude;
            Local.latitude = position.coords.latitude;
            callback();
        });
    }

    // 根据坐标获取地理位置名称
    function getLocalName(coordtype, callback2) {
        var index = layer.open({content: '<i class="fa fa-refresh fa-spin"></i>&nbsp;&nbsp;正在获取位置…', skin:'msg', time:2});
        $('#positioning').html('<i class="fa fa-refresh fa-spin"></i>&nbsp;&nbsp;正在获取位置…');

        var lat_lng = Local.latitude + ',' + Local.longitude;
        if (!coordtype) coordtype = 'wgs84ll';
        $.getJSON('http://api.map.baidu.com/geocoder/v2/?callback=?', {'ak':'9Go7FByT2xPEH5VcPKMiZWoY', 'location':lat_lng, 'coordtype':coordtype, 'output':'json', 'pois':0}, function(result) {
                if (result.status == 0) {
                    callback2(result);
                    layer.close(index);
                    // 这是测试阶段好用，实际情况不需要这些多余的东西
                    // layer.open({
                    //     content: '猜你在：<font color=red>'+result.result.formatted_address+'</font>',
                    //     btn: ['嗯嗯，是的', '错了，笨蛋'],
                    //     yes: function(index){
                    //         layer.close(index);
                    //     },
                    //     no: function(index){
                    //         layer_no();
                    //     },
                    //     time: 1.5,
                    // });
                } else {
                    layer.open({content: '<i class="fa fa-exclamation-triangle"></i>&nbsp;哎呀妈，暂无法获取您的位置。'});
                }
            }
        );
    }

    function getSeller() {
        $('#getmore').hide();
        $('#get_more_load').show();
        var url = "{:U('getShopList')}";
        $.ajax({
            type : "GET",
            url  : url + '?cat=' + cat + '&p=' + p + '&longitude=' + Local.longitude + '&latitude=' + Local.latitude + '&t=' + Math.random(),
            error: function(request) {
                layer.open({
                    content: '服务器繁忙！'
                    ,skin: 'msg'
                    ,time: 2
                });
            },
            success: function(data) {
                $('#get_more_load').hide();
                if (data) {
                    $('#get_more_load').before(data);
                    $('#getmore').show();
                    p++;
                } else {
                    $('#getmore').hide();
                    layer.open({
                        content: p == 1 ? '附近没有' + $($('.icon-list dd a i.on')[0]).next().text() + '商家哦' :'没有更多了哦！'
                        ,skin: 'msg'
                        ,time: 2
                    });
                }
            }
        });
    }

    function getSellerNum() {
        var url = "{:U('getSellerNum')}";
        $.ajax({
            type : "GET",
            url  : url + '?longitude=' + Local.longitude + '&latitude=' + Local.latitude + '&t=' + Math.random(),
            error: function(request) {
                layer.open({
                    content: '服务器繁忙！'
                    ,skin: 'msg'
                    ,time: 2
                });
            },
            success: function(data) {
                $('.seller-num').remove();
                if (data.length !== 0) {
                    $('.icon').removeClass('no');
                    for (var i in data) {
                        if (data[i][1] > 99) {
                            var span = $('<span class="seller-num w no">99+</span>');
                        } else {
                            var span = $('<span class="seller-num no">'+data[i][1]+'</span>');
                        }
                        span.css('background', $('a[data-cat='+data[i][0]+']').find('i').css('background'));
                        $('a[data-cat='+data[i][0]+']').append(span);
                        setTimeout(function() {
                            $('.seller-num').removeClass('no');
                        }, 100+Math.round(Math.random()*100));
                    }
                } else {
                }
            }
        }, 'json');
    }

    // 浏览器定位API
    function getLocationApi(successCallback) {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(successCallback, showError);
        } else {
            layer.open({content: '<i class="fa fa-exclamation-triangle"></i>&nbsp;悲催，浏览器不支持地理定位。'});
        }
    }

    function showError(error) {
        switch(error.code) {
            case error.PERMISSION_DENIED:
                layer.open({content: '<i class="fa fa-exclamation-triangle"></i>&nbsp;定位失败，用户残忍地拒绝了请求地理定位服务'});
                break;
            case error.POSITION_UNAVAILABLE:
                layer.open({content: '<i class="fa fa-exclamation-triangle"></i>&nbsp;定位失败，位置信息是不可用的'});
                break;
            case error.TIMEOUT:
                layer.open({content: '<i class="fa fa-exclamation-triangle"></i>&nbsp;定位失败，请求获取用户位置超时'});
                break;
            case error.UNKNOWN_ERROR:
                layer.open({content: '<i class="fa fa-exclamation-triangle"></i>&nbsp;定位失败，定位系统失效'});
                break;
        }
    }

    var layer_no = function(){
        layer.open({
            content: '<i class="fa fa-meh-o"></i>&nbsp;我错了，我哄你还不行吗，别生气了，嗯？',
            btn: ['再试一次', '我讨厌你'],
            yes: function(index){
                $('#positioning').click();
            },
            no: function(index){
                layer.open({
                    content: '<i class="fa fa-meh-o"></i>&nbsp;别生气了，我真的错了，我错在不乖，连给你定个位都不准，要我有什么用呢，我给你讲个笑话听好不好，不要生气了',
                    btn: ['嗯', '不听'],
                    yes: function(index){
                        layer.open({
                            content: '“小时候去动物园看老虎，看着特威风可爱，暗暗发誓长大以后一定也要养一个。20年后，这个梦想终于实现了。不说了，该给媳妇做饭去了……”',
                            btn: ['好吧，原谅你了', '一点都不好笑'],
                            yes: function(index){
                                layer.open({
                                    content: '嘻嘻，那不要生气了哦，让我再试一次好吧？',
                                    btn: ['嗯嗯', '不用了，你歇一会'],
                                    yes: function(index){
                                        $('#positioning').click();
                                    },
                                    no: function(index){
                                        layer.open({content: '那你不要生气了啊，生气对身体不好。', time:2});
                                    },
                                });
                            },
                            no: function(index){
                                layer.open({content: '<i class="fa fa-frown-o"></i>&nbsp;对不起，我错了，我面壁去了。',time:2});
                            },
                        });
                    },
                    no: function(index){
                        layer.open({content: '<i class="fa fa-frown-o"></i>&nbsp;大哭', time:2});
                    },
                });
            },
        });
    };

</script>

</body>
</html>